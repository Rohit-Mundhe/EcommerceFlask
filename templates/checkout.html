{% extends "base.html" %}
{% block title %}Checkout – ShopZone{% endblock %}

{% block content %}
<div class="container my-4">
  <h4 class="fw-bold mb-4"><i class="bi bi-truck me-2"></i>Checkout</h4>

  <div class="row g-4">

    <!-- Delivery form -->
    <div class="col-lg-7">
      <div class="card border-0 shadow-sm">
        <div class="card-body p-4">
          <h6 class="fw-bold mb-3 border-bottom pb-2">Delivery Details</h6>
          <form method="post" id="checkoutForm">
            <div class="row g-3">
              <div class="col-sm-6">
                <label class="form-label">Full Name <span class="text-danger">*</span></label>
                <input type="text" name="name" class="form-control" value="{{ u.name }}" required>
              </div>
              <div class="col-sm-6">
                <label class="form-label">Phone <span class="text-danger">*</span></label>
                <input type="tel" name="phone" class="form-control" value="{{ u.phone or '' }}" required>
              </div>
              <div class="col-12">
                <label class="form-label">Full Address <span class="text-danger">*</span></label>
                <textarea name="address" class="form-control" rows="2"
                          placeholder="House No, Street, Area…" required></textarea>
              </div>
              <div class="col-sm-5">
                <label class="form-label">City <span class="text-danger">*</span></label>
                <input type="text" name="city" class="form-control" required>
              </div>
              <div class="col-sm-4">
                <label class="form-label">State <span class="text-danger">*</span></label>
                <input type="text" name="state" class="form-control" required>
              </div>
              <div class="col-sm-3">
                <label class="form-label">PIN Code <span class="text-danger">*</span></label>
                <input type="text" name="pincode" class="form-control" required pattern="[0-9]{6}"
                       maxlength="6" placeholder="6 digits">
              </div>
              <div class="col-12">
                <label class="form-label">Delivery Note <span class="text-muted small">(optional)</span></label>
                <input type="text" name="note" class="form-control"
                       placeholder="e.g. Leave at door, call before delivery">
              </div>
            </div>

            <!-- Payment -->
            <div class="mt-4 p-3 bg-light rounded border">
              <h6 class="fw-bold mb-2">Payment Method</h6>
              <div class="form-check">
                <input class="form-check-input" type="radio" checked readonly>
                <label class="form-check-label">
                  <i class="bi bi-cash-coin me-2 text-success"></i>
                  <strong>Cash on Delivery</strong>
                  <span class="text-muted small ms-2">Pay when you receive</span>
                </label>
              </div>
            </div>

            <button type="submit" class="btn btn-warning w-100 fw-bold py-2 mt-4 fs-5">
              <i class="bi bi-check-circle me-2"></i>Place Order
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- Order summary -->
    <div class="col-lg-5">
      <div class="card border-0 shadow-sm">
        <div class="card-body p-4">
          <h6 class="fw-bold mb-3 border-bottom pb-2">
            Your Order <span class="text-muted small">({{ items|length }} item{{ 's' if items|length != 1 }})</span>
          </h6>
          {% for item in items %}
          <div class="d-flex gap-3 align-items-center mb-3">
            <img src="{{ item.image_url or 'https://placehold.co/50x50?text=?' }}"
                 class="rounded" style="width:50px;height:50px;object-fit:cover" alt="{{ item.name }}">
            <div class="flex-grow-1 small">
              <p class="mb-0 fw-semibold lh-sm">{{ item.name }}</p>
              <p class="mb-0 text-muted">Qty: {{ item.qty }}</p>
            </div>
            <span class="fw-semibold">&#8377;{{ "%.2f"|format(item.sub) }}</span>
          </div>
          {% endfor %}
          <hr>
          <div class="d-flex justify-content-between small text-muted mb-1">
            <span>Subtotal</span><span>&#8377;{{ "%.2f"|format(total) }}</span>
          </div>
          <div class="d-flex justify-content-between small text-success mb-2">
            <span>Delivery</span><span class="fw-semibold">FREE</span>
          </div>
          <div class="d-flex justify-content-between fw-bold fs-5">
            <span>Total</span><span>&#8377;{{ "%.2f"|format(total) }}</span>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
{% endblock %}
