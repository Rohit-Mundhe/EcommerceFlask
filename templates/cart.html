{% extends "base.html" %}
{% block title %}Cart â€“ ShopZone{% endblock %}

{% block content %}
<div class="container my-4">
  <h4 class="fw-bold mb-4"><i class="bi bi-cart3 me-2"></i>Shopping Cart</h4>

  {% if items %}
  <div class="row g-4">

    <!-- Cart items -->
    <div class="col-lg-8">
      {% for item in items %}
      <div class="card border-0 shadow-sm mb-3">
        <div class="card-body d-flex gap-3 align-items-center p-3">
          <img src="{{ item.image_url or 'https://placehold.co/80x80?text=?' }}"
               class="rounded" style="width:80px;height:80px;object-fit:cover" alt="{{ item.name }}">
          <div class="flex-grow-1">
            <p class="fw-semibold mb-0">{{ item.name }}</p>
            <p class="text-success fw-bold mb-0">&#8377;{{ "%.2f"|format(item.price) }} each</p>
          </div>
          <!-- Update qty -->
          <form action="{{ url_for('cart_update') }}" method="post" class="d-flex align-items-center gap-2">
            <input type="hidden" name="pid" value="{{ item.id }}">
            <input type="number" name="qty" value="{{ item.qty }}" min="0" max="10"
                   class="form-control form-control-sm text-center" style="width:65px">
            <button class="btn btn-outline-secondary btn-sm">Update</button>
          </form>
          <!-- Subtotal & remove -->
          <div class="text-end ms-2" style="min-width:90px">
            <p class="fw-bold mb-1">&#8377;{{ "%.2f"|format(item.sub) }}</p>
            <form action="{{ url_for('cart_remove', pid=item.id) }}" method="post">
              <button class="btn btn-sm btn-link text-danger p-0 text-decoration-none">
                <i class="bi bi-trash me-1"></i>Remove
              </button>
            </form>
          </div>
        </div>
      </div>
      {% endfor %}

      <form action="{{ url_for('cart_clear') }}" method="post" class="mt-1">
        <button class="btn btn-outline-danger btn-sm">
          <i class="bi bi-x-circle me-1"></i>Clear Cart
        </button>
      </form>
    </div>

    <!-- Order summary -->
    <div class="col-lg-4">
      <div class="card border-0 shadow-sm">
        <div class="card-body p-4">
          <h6 class="fw-bold mb-3">Order Summary</h6>
          <div class="d-flex justify-content-between mb-2">
            <span class="text-muted">Subtotal ({{ items|length }} item{{ 's' if items|length != 1 }})</span>
            <span>&#8377;{{ "%.2f"|format(total) }}</span>
          </div>
          <div class="d-flex justify-content-between mb-3 text-success">
            <span><i class="bi bi-truck me-1"></i>Delivery</span>
            <span class="fw-semibold">FREE</span>
          </div>
          <hr>
          <div class="d-flex justify-content-between fw-bold fs-5 mb-3">
            <span>Total</span>
            <span>&#8377;{{ "%.2f"|format(total) }}</span>
          </div>
          <a href="{{ url_for('checkout') }}" class="btn btn-warning w-100 fw-bold py-2">
            Proceed to Checkout <i class="bi bi-arrow-right ms-1"></i>
          </a>
          <a href="{{ url_for('index') }}" class="btn btn-outline-secondary w-100 mt-2 btn-sm">
            Continue Shopping
          </a>
        </div>
      </div>
    </div>
  </div>

  {% else %}
  <div class="text-center py-5 text-muted">
    <i class="bi bi-cart-x display-4 d-block mb-3"></i>
    <h5>Your cart is empty</h5>
    <p class="small">Add some products to get started!</p>
    <a href="{{ url_for('index') }}" class="btn btn-dark mt-3 px-4">Start Shopping</a>
  </div>
  {% endif %}
</div>
{% endblock %}
